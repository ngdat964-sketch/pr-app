<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">

<!-- ✅ ICON APP iOS (FIX LỖI HIỆN CHỮ Q) -->
<link rel="apple-touch-icon" href="icon.png">

<!-- ✅ CHẶN ZOOM iPHONE -->
<meta name="viewport"
      content="width=device-width,
               initial-scale=1.0,
               maximum-scale=1.0,
               user-scalable=no,
               viewport-fit=cover">

<!-- === THÊM: FULLSCREEN iOS === -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#2f3347">
<!-- === /THÊM === -->

<title>QR Access</title>

<style>
body{
    margin:0;
    background:#2f3347;
    font-family:Arial,sans-serif;
    text-align:center;
    color:#fff;
}

/* ✅ HẠN CHẾ DOUBLE TAP / TEXT ZOOM */
html, body{
    touch-action: manipulation;
    overscroll-behavior: none;
    -webkit-text-size-adjust: 100%;
}

/* TÊN */
.name{
    margin:24px 0 14px;
    font-size:21px;
    font-weight:bold;
    color:#f0d58c;
}

/* CARD */
.card{
    width:80%;
    max-width:320px;
    margin:0 auto;
    background:#fff;
    border-radius:22px;
    padding-bottom:24px;
    color:#000;
    overflow:hidden;
}

/* HEADER */
.card-header{
    position:relative;
    background:#ffb703;
    color:#fff;
    padding:13px 12px;
    font-size:14px;
}

/* KHUYẾT */
.card-header::before,
.card-header::after{
    content:"";
    position:absolute;
    bottom:-7px;
    width:14px;
    height:14px;
    background:#2f3347;
    border-radius:50%;
}
.card-header::before{ left:-7px; }
.card-header::after{ right:-7px; }

/* DATE */
.datetime{
    margin:24px 0 14px;
    font-size:20px;
    font-weight:bold;
    white-space:nowrap;
}

/* QR */
.qr{
    margin:6px auto;
    width:230px;
    position:relative;
}

/* === THÊM: KHỐI BAO QR + TIME === */
.qr-wrap{
    position:relative;
    padding:18px 12px 14px;
    background:#fff;
}
.qr-wrap::before,
.qr-wrap::after{
    content:"";
    position:absolute;
    width:18px;
    height:18px;
    background:#2f3347;
    border-radius:50%;
}
.qr-wrap::before{
    top:-9px; left:-9px;
}
.qr-wrap::after{
    top:-9px; right:-9px;
}
.qr-wrap .cut-bot::before,
.qr-wrap .cut-bot::after{
    content:"";
    position:absolute;
    width:18px;
    height:18px;
    background:#2f3347;
    border-radius:50%;
    bottom:-9px;
}
.qr-wrap .cut-bot::before{ left:-9px; }
.qr-wrap .cut-bot::after{ right:-9px; }
/* === /THÊM === */

.qr img{
    width:100%;
    transition:opacity .3s ease;
}

/* LOADING */
.qr-loading{
    position:absolute;
    top:50%;
    left:50%;
    width:30px;
    height:30px;
    margin:-15px;
    border:3px solid rgba(0,0,0,.25);
    border-top-color:#ffb703;
    border-radius:50%;
    animation:spin .8s linear infinite;
    display:none;
}
@keyframes spin{
    to{transform:rotate(360deg);}
}

/* REFRESH */
.refresh{
    margin-top:10px;
    color:#888;
    font-size:14px;
}

/* TIMER */
.timer{
    margin-top:6px;
    font-size:24px;
    font-weight:bold;
    color:#2ecc71;
}

/* === THÊM: DÒNG XANH NHẤP NHÁY === */
.status{
    margin-top:8px;
    font-size:15px;
    color:#2ecc71;
    animation:blink 1.5s infinite;
}
@keyframes blink{
    0%,49%{opacity:1;}
    50%,100%{opacity:0;}
}
/* === /THÊM === */

/* NOTE */
.note{
    margin:24px auto;
    max-width:300px;
    font-size:14px;
    color:#bfc3d9;
    line-height:1.85;
    text-align:left;
}
.note .line{
    display:block;
}
</style>
</head>

<body>

<div class="name">
Nguyễn Anh Tuấn (V25092261)
</div>

<div class="card">

    <div class="card-header">
        将二维码对准扫描器刷新出场
    </div>

    <div class="datetime" id="datetime"></div>

    <!-- === THÊM: BAO QR + STATUS + TIME (KHÔNG ĐỔI THỨ TỰ GỐC) === -->
    <div class="qr-wrap">
        <div class="qr">
            <img id="qrImage" src="qr.png">
            <div class="qr-loading" id="qrLoading"></div>
        </div>

        <div class="status">已生效</div>

        <div class="timer" id="timer">00:00</div>

        <div class="cut-bot"></div>
    </div>
    <!-- === /THÊM === -->

    <div class="refresh" onclick="refreshQR()">刷新二维码</div>

</div>

<div class="note">
    <span class="line">尊敬的员工您好，您已进入企业涉密区域，</span>
    <span class="line">出于企业安全考虑，您的手机摄像头将被禁止，</span>
    <span class="line">感谢您的配合。</span>
</div>

<script>
// DATE TIME
function updateDateTime(){
    const n=new Date();
    document.getElementById("datetime").innerText=
        n.getFullYear()+"-"+
        String(n.getMonth()+1).padStart(2,"0")+"-"+
        String(n.getDate()).padStart(2,"0")+" "+
        String(n.getHours()).padStart(2,"0")+":"+
        String(n.getMinutes()).padStart(2,"0")+":"+
        String(n.getSeconds()).padStart(2,"0");
}
setInterval(updateDateTime,1000);
updateDateTime();

// TIMER (GIỮ NGUYÊN LOGIC)
let seconds=0;
setInterval(()=>{
    seconds++;
    renderTimer();
},1000);

function renderTimer(){
    document.getElementById("timer").innerText=
        String(Math.floor((seconds%3600)/60)).padStart(2,"0")+":"+
        String(seconds%60).padStart(2,"0");
}

// CLICK 3 LẦN (GIỮ NGUYÊN)
let clickCount=0;
let step=0;
const steps=[
    2*3600+30*60,
    5*3600,
    8*3600,
    0
];
document.querySelector(".name").onclick=()=>{
    clickCount++;
    if(clickCount===3){
        seconds=steps[step];
        renderTimer();
        step=(step+1)%steps.length;
        clickCount=0;
    }
};

// QR LOAD (GIỮ NGUYÊN)
function refreshQR(){
    const img=document.getElementById("qrImage");
    const loading=document.getElementById("qrLoading");

    img.style.opacity="0.4";
    loading.style.display="block";

    setTimeout(()=>{
        img.src="qr.png?t="+Date.now();
        img.style.opacity="1";
        loading.style.display="none";
    },600);
}

/* ✅ CHẶN PINCH ZOOM & DOUBLE TAP (GIỮ NGUYÊN) */
document.addEventListener('touchmove', function(e){
    if(e.scale && e.scale !== 1){
        e.preventDefault();
    }
}, { passive:false });

let lastTouchEnd=0;
document.addEventListener('touchend', function(e){
    const now=Date.now();
    if(now-lastTouchEnd<=300){
        e.preventDefault();
    }
    lastTouchEnd=now;
}, false);
</script>

</body>
</html>
